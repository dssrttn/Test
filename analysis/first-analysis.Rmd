---
title: "First-Analysis"
output: 
  html_document:
    code_folding: hide
---

       

## Erste Analyse

Dies ist ein erster Versuch zur Durchführung meiner Dissertation mithilfe von workflowr und **markdown**. 

##### Zweite Analyse

This is an ~~R Markdown~~ document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a *document will be generated* that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:





```{r}

DIL_1 <- read.table('data/DIL_1.csv', header=TRUE, stringsAsFactors=FALSE, sep=";", dec=",", row.names="Dosisname")

summary(DIL_1)
str(DIL_1)


x <- (1:14)
y <- DIL_1$Mittelwert

y.sd <- DIL_1$sigma


var(DIL_1$Mittelwert)
```


## Anteil der Personen, die mehr als den Boost constraint haben 
```{r}
#If you have a data frame named DF and a column named age: mean(DF$age > 65). The comparison DF$age > 65 returns TRUE or FALSE. TRUE equals 1 and FALSE equals 0. The mean of the comparison is thus the fraction that are TRUE.


mean(DIL_1$Mittelwert > 76.23)

```



## Including Plots
```{r, fig.width=11, fig.height=7, dev=c('png', 'pdf')}
par(family="serif") # Schriftart
par(lwd = 2)
par(mar = c(6, 8, 2, 2)) # Abstände um den Plot. 2. Position y-Achse
par(mgp=c(5,1,0)) # mpg: Abstand Label zu Achse
plot(x, y, ylim=c(74, 80.2), xlab="Fraction", ylab="Dose in Gray", family="serif", cex = 1, # Größe der Punkte im plot
    cex.lab=2.5, # Größe der Erläuterungen der Achsen
    cex.axis = 1.5, # Größe Tickbezeichnungen
    axes = FALSE , 
    pch=16, #main="Dosisverteilung DIL Mittelwert 1"
     type="b")
text(x=13.3, y = 75.8, labels="Boost constraint"
       #"Dosisvorgabe Boost"
       , family="serif", cex = 1.4) 
text(x=11.9, y = 80.2, labels="+5% deviation from boost constraint"
       #"+5% Abweichung von Dosisvorgabe"
     , family="serif", cex = 1.4)
axis(1, at=x, label=x, tick=F, cex.axis=2, family="serif")
arrows(x0=x, y0=y-y.sd, x1=x, y1=y+y.sd, code=3, angle=90, length=0.05)
abline(a=76,23, b=0, lty=2)
abline(a=80.04, b=0, lty=2)
axis(2, at=seq(74,81,0.5), tick=F, las=2, cex.lab=8, cex.axis=2, family="serif")
```

## Kleinerer line plot
```{r, echo = FALSE, fig.width=11, fig.height=7, dev=c('png', 'pdf')}
par(family="serif") # Schriftart
par(lwd = 2)
par(cex.lab=2.5)      # Größe der Erläuterungen der Achsen
par(mar = c(6, 8, 2, 2)) # Abstände um den Plot. 2. Position y-Achse
par(mgp=c(5,1,0)) # mpg: Abstand Label zu Achse
plot(x, y, ylim=c(76.1, max(DIL_1$Mittelwert)),
     xlab="Fraction", 
     ylab="Dose in Gray", 
    cex = 1, # Größe der Punkte im plot
   # cex.axis = 1.5, # Tickbezeichnungen
    #axes = FALSE , 
    pch=16, #main="Dosisverteilung DIL Mittelwert 1"
     type="b",
     las = 2) # horizontale Markierung der Tick-Beschriftungen

text(x=13.3, y = 76.27, labels="Boost constraint"
       #"Dosisvorgabe Boost"
       , family="serif", cex = 1.4)
abline(a=76.23, b=0, lty=2)
#axis(1, las = 2)
#at=x, label=x, #tick=F, cex.axis=2)

#axis(2, at=seq(74,81,0.5), #tick=F, las=2, cex.lab=8, cex.axis=2, family="serif")
```



```{r}




par(bty="n") # keinen Rahmen
par(family="serif") # Schriftart
par(mar = c(2, 8, 2, 2)) # Abstände um den Plot. 2. Position y-Achse
par(mgp=c(4.2,1,0)) # mpg: Abstand Label zu Achse
boxplot(DIL_1$Mittelwert, 
        ylab= "Dosis in Gray", #y-Achse-Beschriftung  
        #yaxt="n", #suppresses y-axis. Brauch ich das? 
        col="transparent", #Farbe des Boxplots
        las = 2, # horizontale Markierung der Tick-Beschriftungen
        ylim=c(min(DIL_1$Mittelwert), max(DIL_1$Mittelwert)), # y-Achse range
        cex.lab = 2, # Größe Label-Beschriftung
        cex.axis = 1.5 # Größe Achsenbeschriftungen
        #mgp=c(3,1,0) # mpg: Abstand Label zu Achse
     # , xpd = TRUE
      #labels = FALSE
        )

```








### Ein weiterer Unterpunkt
### Noch einer


```{r}
par(family="serif") # Schriftart
par(mar = c(5, 5, 2, 2)) # Abstände um den Plot. 2. Po´ition y-Achse
par(mgp=c(3,1,0)) # mpg: Abstand Label zu Achse
hist(DIL_1$Mittelwert, 
    main="",
    #DIL Mittelwert" 
     ylab="Dichte der Dosiswerte", xlab="Dosis in Gray", mgp=c(3,1,0), las = 1, freq = FALSE, ylim=c(0, 2), xlim=c(76.2, 77.6), cex.lab=2, cex.axis=1.5, col = "transparent")
rug(jitter(DIL_1$Mittelwert))
lines(density(DIL_1$Mittelwert), col="black", lwd=2)
#cex.lab=1.5, cex.axis=1.5
```



Lorem ipsum


``` {r echo = FALSE, fig.width=10, fig.height=7, dev=c('png', 'pdf')}
library(ggplot2)
data <- data.frame(
x <- (1:14),
y <- DIL_1$Mittelwert
)

ggplot(data, aes(x=x, y=y, label = y)) +
  geom_segment( aes(x=x, xend=x, y=76.23, yend=y), color="grey") +
  geom_point( color="orange", size=4) +
  #geom_text(nudge_x = 1.5) +
   expand_limits(y = c(75.0, 78)) +
  theme_light() +
geom_abline(intercept = 76.23, slope = 0) + # horizontale Linie ohne Steigung, da slope = 0
 scale_x_continuous(breaks = 0:14) + # für jedes x ein tick
  scale_y_continuous(breaks = seq(75.0,78.0,0.5)) + 
  theme_bw() + # remove grid lines, background color ...
    theme(
      panel.border = element_blank(), 
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank(), 
      axis.line = element_line(colour = "black")) +
    
    
  xlab("") +
  ylab("Dose in Gray")
```


```{r}
76.23*1.01
76.23*1.02
76.23*1.03
76.23*1.04
76.23*1.05

``` 



``` {r echo = FALSE, fig.width=10, fig.height=7, dev=c('png', 'pdf')}
library(ggplot2)
data <- data.frame(
x <- (1:14),
y <- DIL_1$Mittelwert
)

ggplot(data, aes(x=x, y=y, label = y)) +
  geom_segment( aes(x=x, xend=x, y=76.23, yend=y), color="grey") +
  geom_point( color="orange", size=4) +
  #geom_text(nudge_x = 1.5) +
   expand_limits(y = c(75.0, 80.5)) +
  theme_light() +
  geom_abline(intercept = 76.23, slope = 0) + # horizontale Linie ohne Steigung, da slope = 0
  geom_abline(intercept = 76.23*1.01, slope = 0) +  
  geom_abline(intercept = 76.23*1.02, slope = 0) +
  geom_abline(intercept = 76.23*1.03, slope = 0) +
  geom_abline(intercept = 76.23*1.04, slope = 0) +
  geom_abline(intercept = 76.23*1.05, slope = 0) +
 scale_x_continuous(breaks = 0:14) + # für jedes x ein tick
  scale_y_continuous(breaks = seq(75.0,80.5,0.5)) + 
  theme_bw() + # remove grid lines, background color ...
    theme(
      panel.border = element_blank(), 
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank(), 
      axis.line = element_line(colour = "black")) +
    
    
  xlab("") +
  ylab("Dose in Gray")
```



``` {r echo = FALSE, fig.width=10, fig.height=7, dev=c('png', 'pdf')}
library(ggplot2)
data <- data.frame(
x <- (1:14),
y <- DIL_1$Mittelwert
)
#colour = cut(SLEEP, c(-Inf, summary(SLEEP)[[2]], summary(SLEEP)[[5]], Inf))),
 #   size = 3, show.legend = FALSE ) +
  #scale_color_manual(values = c('green', 'orange', 'red')

ggplot(data, aes(x=x, y=y, label = y)) +
  geom_point(
    aes(colour = cut(DIL_1$Mittelwert, c(-Inf, 76.23, 77.0, Inf)), size = 3, show.legend = FALSE)) + 
    scale_color_manual(name = "Mittelwert",
      values = c("(-Inf,76.23]" = "green",
                 "(76.23, 77.0]" = "red",
                 "(77.0, Inf]" = "orange"),
  labels = c("up to 76.23", "76.23 to 77", "over 77")) +
      #values = c("(-Inf,76.23]" = "black",(76.23, 77.0]" = "yellow","(77.0, Inf]" = "red")), +
     # labels = c("<= 76.23", "76.23 < DIL_1$Mittelwert <= 77.0", "> 77.0")) +
  geom_segment(aes(x=x, xend=x, y=76.23, yend=y), color="grey") +
  #geom_point( color="orange", size=4) +
  #geom_text(nudge_x = 1.5) +
   expand_limits(y = c(75.0, 80.5)) +
  theme_light() +
  geom_abline(intercept = 76.23, slope = 0) + # horizontale Linie ohne Steigung, da slope = 0
  #geom_abline(intercept = 76.23*1.01, slope = 0) +  
  #geom_abline(intercept = 76.23*1.02, slope = 0) +
  #geom_abline(intercept = 76.23*1.03, slope = 0) +
  #geom_abline(intercept = 76.23*1.04, slope = 0) +
  #geom_abline(intercept = 76.23*1.05, slope = 0) +
 scale_x_continuous(breaks = 0:14) + # für jedes x ein tick
  scale_y_continuous(breaks = seq(75.0,80.5,0.5)) + 
  theme_bw() + # remove grid lines, background color ...
    theme(
      panel.border = element_blank(), 
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank(), 
      axis.line = element_line(colour = "black")) +
  xlab("") +
  ylab("Dose in Gray")
 
```



```{r}
# library
library(plotrix)
 
#create color palette
library(RColorBrewer)
my_colors = brewer.pal(8, "Set2") 
 
# Create data
x <- seq(1:14)
y <- y <- DIL_1$Mittelwert
 
# Plot x and y
par(mar=c(4,4,2,2))
clplot(x, y, main="", lwd=5, levels=c(76.23*1.01, 76.23*1.02, 76.23*1.03, 76.23*1.04, 76.23*1.05), col=my_colors, showcuts=T , bty="n")


```



```{r}

library(ggplot2)
data <- data.frame(
x <- (1:14),
y <- DIL_1$Mittelwert
)
ggplot(data, aes(x, y)) +
  geom_line() + #linetype = 0) + um Linie zu entfernen
  geom_point(
    aes(colour = cut(DIL_1$Mittelwert, c(-Inf, summary(DIL_1$Mittelwert)[[2]], summary(DIL_1$Mittelwert)[[5]], Inf))),
    size = 3, show.legend = FALSE ) +
  scale_color_manual(values = c('green', 'orange', 'red')) +
  labs(title = 'DIL_1$Mittelwert (hrs)', x = NULL, y = NULL) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 8, face = 'bold'),
    panel.grid = element_blank() )

```



```{r}

library(ggplot2)
library(ggthemes)
data <- data.frame(
x <- (1:14),
y <- DIL_1$Mittelwert
)
ggplot(data, aes(x, y)) +
  geom_line() + #linetype = 0) + um Linie zu entfernen
  geom_point(
    aes(colour = cut(DIL_1$Mittelwert, c(-Inf, 76.23, 76.23*1.01,  76.23*1.02, 76.23*1.03, 76.23*1.04, 76.23*1.05, Inf))),
    size = 3, show.legend = FALSE ) +
  expand_limits(y = c(75.0, 80.5)) +
  scale_color_manual(values = c('green', 'yellow', 'blue', 'orange', 'red')) +
  labs(title = 'DIL Mittelwert constraints', x = NULL, y = NULL) +
  theme_light() +
geom_abline(intercept = 76.23, slope = 0) + # horizontale Linie ohne Steigung, da slope = 0
 scale_x_continuous(breaks = 0:14) + # für jedes x ein tick
  scale_y_continuous(breaks = seq(75.0,80.5,0.5)) + 
   theme_bw() + # remove grid lines, background color ...
   theme(
   panel.border = element_blank(), 
   panel.grid.major = element_blank(),
   panel.grid.minor = element_blank(), 
   axis.line = element_line(colour = "black")) +
   annotate("text", x = c(14.5), y = c(76.0), adj=1,  #family="serif",
           label = c("Boost constraint")) +
  xlab("Fraction") +
  ylab("Dose in Gray")

```


```{r, fig.width=11, fig.height=7, dev=c('png', 'pdf')}
library(ggplot2)
library(ggthemes)
DIL_1_MW <- data.frame(
x <- (1:14),
y <- DIL_1$Mittelwert
)

#par(family="serif") # Schriftart
#par(lwd = 2)
#par(mar = c(6, 8, 2, 2)) # Abstände um den Plot. 2. Position y-Achse

par(mar = c(5, 5, 2, 2)) # Abstände um den Plot. 2. Po´ition y-Achse
par(mgp=c(3,1,0)) # mpg: Abstand Label zu Achse
ggplot(DIL_1_MW, aes(x,y)) +
  geom_line() + 
  geom_point(size=3) + 
  theme_tufte(base_size = 15) +
  theme(#axis.title=element_blank(), # lässt keine Achsenbeschreibung zu
    axis.text=element_text(size=rel(1.5))) + 
   expand_limits(y = c(75.0, 80.2)) +
  #labs(y = "Dose in Gray") +
  #labs(x = "Fraction") +
  #axis.title.x = element_text(size = rel(6)) +
geom_hline(yintercept = c(76.23, 80.04), lty=2) +
 scale_y_continuous(breaks=seq(74, 81, 0.5)) + #label=seq((74 81))) + 
  scale_x_continuous(breaks=x,label=x) +
 # labs(x = "Dose (mg)", y = "Teeth length")
 annotate("text", x = 13.4, y = 76.0, cex =rel(6), label = "Boost constraint") +
 annotate("text", x = 12, y = 79.8, cex =rel(6), label = "+5% deviation from boost constraint")
        
```

```{r}
library(ggplot2)
library(ggthemes)
x <- 1967:1977
y <- c(0.5,1.8,4.6,5.3,5.3,5.7,5.4,5,5.5,6,5)
d <- data.frame(x, y)
ggplot(d, aes(x,y)) + geom_line() + geom_point(size=3) + theme_tufte(base_size = 15) +
  theme(axis.title=element_blank()) + geom_hline(yintercept = c(6), lty=2) + 
  scale_y_continuous(breaks=seq(1, 6, 1), label=sprintf("$%s",seq(300,400,20))) + 
  scale_x_continuous(breaks=x,label=x) +
  annotate("text", x = c(1977,1977.2), y = c(1.5,5.5), adj=1,  family="serif",
           label = c("Per capita\nbudget expandures\nin constant dollars", "5%"))

```
